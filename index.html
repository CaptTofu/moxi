<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

    <title>NorthScale Labs:memcached moxi</title>

    <link id="master_css" rel="stylesheet" type="text/css" href="/css/default.css"/>
  </head>

  <body>

    <div id="header">
      <a href="http://labs.northscale.com">
        <img src="/images/ns_logo_labs.png" alt="NorthScale Labs" style="margin-top:10px;"/>
      </a>
    </div>

    <div id="container">

      <h1>moxi</h1>

      <h2>memcached + integrated proxy + more</h2>

      <p>moxi is a memcached proxy with several features which can
        help keep the memcached contract whole in complicated
        environments.  It also brings several optimizations to
        memcached deployments, without requiring any changes to the
        application software using memcached.</p>
      <p>See this <a href="moxi information 7.17.09.pdf">summary</a>
        for a quick, highlevel overview.</p>

      <h3>Obtaining</h3>
      <p>Version 0.9.6 is the latest release of moxi, and it became
      available on the 16th of August, 2009.  We plan for packages
      of this release in both .deb and .rpm to be available soon.
      Right now, the release is available via github as listed
      below.  See the <a href="changelog.html">changelog</a> for some
      clues on what has changed.</p>

      <h3>The basics</h3>
      <ul>
        <li>Open-source, same BSD license as memcached.
        </li>
        <li>Written in C.
        </li>
        <li>Based on the latest memcached server code for
            its high-performance connection and protocol handling.
        </li>
        <li>Uses the libmemcached for its rich hashing features
            (consistent hashing, etc).
        </li>
        <li>Uses libevent for both upstream (client) and downstream
            connection handling.
        </li>
      </ul>

      <h3>Protocol support</h3>
      <ul>
        <li>memcached text protocol, for upstream and downstream communication
        </li>
        <li>memcached binary protocol, for downstream communication
        </li>
        <li>later: binary support for upstream communication, and
            mixing and matching protocols (eg, some downstream servers
            are text, some are binary).
        </li>
      </ul>

      <h3>Optimizations</h3>
      <ul>
        <li>
          Multi-get Escalation and Protocol Pipelining - de-duplicates
          requests for popular keys, based on ideas from Dustin Sallings'
          spymemcached Java client library for memcached. See:
          <a href="http://code.google.com/p/spymemcached/wiki/Optimizations">code.google.com/p/spymemcached/wiki/Optimizations</a>
        </li>
        <li>
          Front cache - an L1 cache, to avoid network hops.
        </li>
        <li>
          Fire &amp; forget SET - optinally return STORED from SET requests so that the application can proceed, based on key-prefix matches.  (For those clients that don't do noreply.)
        </li>
        <li>
          Timeouts - set maximum time for operations. eg, "no downstream memcached operation should take more than X ms."
        </li>
      </ul>

      <h3>Statistics</h3>
      <ul>
        <li>
          Statistics are tracked independently on each thread, optimized for the 99% case of being a good proxy. A once-in-awhile request for proxy statistics will perform an internal scatter-gather inside moxi to aggregate statistics.
        </li>
      </ul>

      <h3>Configuration</h3>
      <ul>
        <li>Based on <a href="http://labs.northscale.com/libconflate">libconflate</a> reconfiguration to allow dynamic server pool reconfigurations.
        </li>
        <li>
          Assuming you run moxi on your web/app server boxes and you're using <a href="http://labs.northscale.com/libconflate">libconflate</a>, your development, staging and production configurations gets easy: always point your memcached clients to "localhost:11211" (or whatever port you run moxi on).
        </li>
      </ul>

      <h3>Features inherited from memcached</h3>
      <ul>
        <li>
          moxi is built "on the shoulders of giants", that is, memcached, so there's lots to inherit...
        </li>
        <li>
          Multi-platform
        </li>
        <li>
          Multi-threaded
        </li>
        <li>
          Daemonizable
        </li>
        <li>
          Run as another user
        </li>
        <li>
          Bindable to IP interface, default is INADDR_ANY
        </li>
        <li>
          PID file
        </li>
        <li>
          etc
        </li>
      </ul>

      <h3>Presentations</h3>
      <p>
        A subset of these slides were presented at OSCON 2009 as a 
        Lightning Talk - </p>

<div style="width:425px; text-align:left;" id="__ss_1747476">
<a style="font:14px Helvetica,Arial,Sans-serif; display:block;margin:12px 0 3px 0;text-decoration:underline;" 
href="http://www.slideshare.net/northscale/moxi-memcached-proxy" 
title="moxi - memcached + integrated proxy + more">memcached + integrated 
proxy + more</a><object style="margin:0px" width="425" height="355">
<param name="movie" value="http://static.slidesharecdn.com/swf/ssplayer2.swf?doc=moxiabout-090721035815-phpapp02&stripped_title=moxi-memcached-proxy" /><param name="allowFullScreen" value="true"/><param name="allowScriptAccess" value="always"/><embed src="http://static.slidesharecdn.com/swf/ssplayer2.swf?doc=moxiabout-090721035815-phpapp02&stripped_title=moxi-memcached-proxy" type="application/x-shockwave-flash" allowscriptaccess="always" allowfullscreen="true" width="425" height="355"></embed></object>
<div style="font-size:11px;font-family:tahoma,arial;height:26px;padding-top:2px;">View more <a style="text-decoration:underline;" href="http://www.slideshare.net/">documents</a> from <a style="text-decoration:underline;" href="http://www.slideshare.net/northscale">NorthScale</a>.</div>
</div>

      <h3>Obtaining the Source</h3>
      <!--
      <p>
      You can download this project in either
      <a href="http://github.com/northscale/moxi/zipball/master">zip</a> or
      <a href="http://github.com/northscale/moxi/tarball/master">tar</a> formats.
      </p>
      -->
      <p>
        You can clone the project
        with <a href="http://git-scm.com">git</a> by running:
      </p>
      <pre>$ git clone git://github.com/northscale/moxi</pre>

      <p>
        There are several dependencies to be noted if you're building
        from source.  They are either bundled or should generally be
        available in most OS distributions.
      </p>

      <ul>
        <li><a href="http://tangent.org">libmemcached</a> (specific
          version, statically linked and bundled)</li>
        <li><a href="http://monkey.org/~provos/libevent/">libevent</a>,
          a portable event notification layer for socket/file descriptor
          events on UNIX like systems</li>
        <li><a href="http://check.sourceforge.net">check</a>, a C unit test
          framework (needed only for testing, we're fans of test driven
          design)</li>
      </ul>

      <p>For more information on depedencies and building, see the project
        <a href="http://wiki.github.com/northscale/moxi">wiki</a>.  If you
        have questions, please join our
        <a href="http://groups.google.com/group/moxi">discussion group</a>
        to ask!
      </p>

      <h3>Installation</h3>
      <p>Packages will shortly be available for the most common platforms,
        and that is the preferred method of installation.  Otherwise, the
        source is automake/autconf based and should build on most UNIX and
        GNU/Linux systems.
      </p>

      <h3>Test suites</h3>
      <ul>
        <li>moxi aims to pass all the relevant memcached server
            compatibility tests.
        </li>
        <li>moxi has many new test cases to exercise proxy-only
            features and topologies.
        </li>
      </ul>

      <pre>$ make test
$ make check
$ make test_moxi</pre>

      <h3>License</h3>
      <p>New BSD</p>

      <h3>What's next?  Want to help?</h3>
      <p>
        We'd love to hear your ideas, feedback and patches/improvements.
        Join us on the
        <a href="http://groups.google.com/group/moxi">moxi discussion group</a>
        if you want to collaborate.
      </p>

      <p>
        Or, hit that fork button on
        <a href="http://github.com/northscale/moxi/tree/master">
        http://github.com/northscale/moxi/tree/master</a>
      </p>

      <h3>Contact</h3>

      <p><a href="mailto:feeedback@northscale.com">feedback@northscale.com</a></p>
      <p>Alternatively, you may post comments below using disqus.</p>

      <div id="disqus_thread"></div>
      <script type="text/javascript"
              src="http://disqus.com/forums/labsnorthscale/embed.js"></script>
      <noscript>
        <p>
          <a href="http://labsnorthscale.disqus.com/?url=ref">View the
          discussion thread.</a>
        </p>
      </noscript>
      <a href="http://disqus.com"
         class="dsq-brlink">comments powered by
        <span class="logo-disqus">Disqus</span></a>
    </div>

    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-0000000-1");
        pageTracker._trackPageview();
      } catch(err) {}</script>
    <script type="text/javascript">
      //<![CDATA[
            (function() {
                var links = document.getElementsByTagName('a');
                var query = '?';
                for(var i = 0; i < links.length; i++) {
                    if(links[i].href.indexOf('#disqus_thread') >= 0) {
                        query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
                    }
                }
                document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/labsnorthscale/get_num_replies.js' + query + '"></' + 'script>');
            })();
            //]]>
    </script>

    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
        var pageTracker = _gat._getTracker("UA-7763794-3");
        pageTracker._trackPageview();
      } catch(err) {}</script>

  </body>
</html>
